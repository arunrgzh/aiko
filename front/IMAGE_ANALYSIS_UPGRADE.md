# üîç AI Image Analysis - Vision Support

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π! AI —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é GPT-4o Vision API.

## ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### Backend (Python)

- **–°—Ö–µ–º–∞**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `images: Optional[List[str]]` –≤ `SendMessageRequest`
- **API**: –û–±–Ω–æ–≤–ª–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç `/assistants/{id}/chat` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ base64
- **Azure OpenAI**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Vision API –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
    ```json
    {
        "role": "user",
        "content": [
            { "type": "text", "text": "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" },
            {
                "type": "image_url",
                "image_url": { "url": "data:image/jpeg;base64,..." }
            }
        ]
    }
    ```

### Frontend (React/TypeScript)

- **–£—Ç–∏–ª–∏—Ç—ã**: –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `convertToBase64()` –∏ `convertFilesToBase64()`
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: –û–±–Ω–æ–≤–ª–µ–Ω—ã `ChatView.tsx` –∏ `useChatSend.tsx` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–¢–∏–ø—ã**: –†–∞—Å—à–∏—Ä–µ–Ω `SendMessageRequest` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `images?: string[]`

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ AI —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

AI –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

üìã **–†–µ–∑—é–º–µ** - —Å–∫–∞–Ω—ã –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Ä–µ–∑—é–º–µ
üìÑ **–î–æ–∫—É–º–µ–Ω—Ç—ã** - –ª—é–±—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º  
üíº **–í–∞–∫–∞–Ω—Å–∏–∏** - —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
üéØ **–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∫–æ–º–ø–∞–Ω–∏–π** - –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—é
üìä **–ì—Ä–∞—Ñ–∏–∫–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã** - –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ó–∞–≥—Ä—É–∑–∫–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —á–∞—Ç
2. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è**: Frontend –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ base64
3. **–û—Ç–ø—Ä–∞–≤–∫–∞**: –°–æ–æ–±—â–µ–Ω–∏–µ + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ backend
4. **–ê–Ω–∞–ª–∏–∑**: GPT-4o Vision –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
5. **–û—Ç–≤–µ—Ç**: AI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Å–æ–≤–µ—Ç—ã

## ‚ö° –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Base64 –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è

```typescript
const imageBase64s = await convertFilesToBase64(attachments)
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ API

```typescript
await sendMessage({
    participant: conversationId,
    message: processedMessage,
    images: imageBase64s.length > 0 ? imageBase64s : undefined,
})
```

### OpenAI Vision —Ñ–æ—Ä–º–∞—Ç

```python
content = [
    {"type": "text", "text": user_message}
]
for image_base64 in images:
    content.append({
        "type": "image_url",
        "image_url": {"url": f"data:image/jpeg;base64,{image_base64}"}
    })
```

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å AI –º–æ–∂–µ—Ç **–†–ï–ê–õ–¨–ù–û** –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç:

- –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–æ—Ç–æ —Ä–µ–∑—é–º–µ ‚Üí –ø–æ–ª—É—á–∏—Ç—å —Å–æ–≤–µ—Ç—ã –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ ‚Üí –ø–æ–ª—É—á–∏—Ç—å –ø–ª–∞–Ω –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏
- –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã ‚Üí –ø–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–î–æ**: "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –ø–æ–∫–∞ –Ω–µ –º–æ–≥—É –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
**–ü–æ—Å–ª–µ**: "–û—Ç–ª–∏—á–Ω–æ! –Ø –≤–∏–∂—É –≤–∞—à–µ —Ä–µ–∑—é–º–µ. –í–æ—Ç –º–æ–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏..."

## üõ†Ô∏è –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

**Backend:**

- `backend/app/schemas/chat.py` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ images
- `backend/app/api/assistants.py` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Vision API

**Frontend:**

- `front/src/app/(protected-pages)/main/ai-chat/utils/fileUtils.ts` - —É—Ç–∏–ª–∏—Ç—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- `front/src/app/(protected-pages)/main/ai-chat/_components/ChatView.tsx` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `front/src/app/(protected-pages)/main/ai-chat/_hooks/useChatSend.tsx` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `front/src/services/AssistantsService.ts` - —Ç–∏–ø—ã API
